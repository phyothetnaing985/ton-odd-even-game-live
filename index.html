<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>TON Odd & Even Game</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    
    <style>
        :root {
            --tg-theme-bg: #1e1e1e; 
            --tg-theme-secondary-bg: #2a2a2a; 
            --tg-theme-text: #ffffff; 
            --tg-theme-button: #007bff; 
            --accent-color: #4CAF50;
            --footer-height: 60px;
        }

        body {
            margin: 0; padding: 0;
            background: var(--tg-theme-bg);
            color: var(--tg-theme-text);
            font-family: sans-serif;
            overflow-x: hidden;
        }

        #app-container { display: flex; flex-direction: column; min-height: 100vh; padding-bottom: var(--footer-height); }
        .screen { display: none; flex-direction: column; align-items: center; padding: 20px; }
        .header { width: 100%; display: flex; justify-content: space-between; align-items: center; padding: 15px; background: var(--tg-theme-secondary-bg); box-sizing: border-box; }
        
        /* Game Card Style */
        .game-card { background: var(--tg-theme-secondary-bg); border-radius: 15px; padding: 20px; width: 90%; max-width: 400px; text-align: center; margin-top: 20px; }
        .character-img { width: 100%; border-radius: 10px; margin-bottom: 15px; }
        .play-button { background: var(--accent-color); color: white; border: none; padding: 15px; width: 100%; border-radius: 10px; font-weight: bold; font-size: 1.1rem; cursor: pointer; }
        .play-button:disabled { background: #555; cursor: not-allowed; }

        /* Footer */
        .footer { position: fixed; bottom: 0; width: 100%; height: var(--footer-height); background: var(--tg-theme-secondary-bg); display: flex; justify-content: space-around; align-items: center; border-top: 1px solid #444; }
        .nav-item { color: #888; text-align: center; font-size: 0.8rem; cursor: pointer; }
        .nav-item.active { color: var(--tg-theme-button); }
        
        /* Wallet Button Placeholder */
        #ton-connect-btn { margin-top: 10px; }
    </style>
</head>
<body>

<div id="app-container">
    <div class="header">
        <div id="ton-connect-btn"></div>
        <div id="balance-display">ðŸ’Ž 0.00 TON</div>
    </div>

    <div id="lobby-screen" class="screen" style="display: flex;">
        <div class="game-card">
            <img src="https://picsum.photos/400/250" class="character-img" alt="Lobby">
            <h3>ODD & EVEN (x1.9)</h3>
            <p style="color: #aaa; font-size: 0.9rem;">Connect Wallet to start playing</p>
            <button id="play-now-btn" class="play-button" disabled>PLAY NOW</button>
        </div>
    </div>

    <div id="game-screen" class="screen"><h2>Game Area</h2><button onclick="showScreen('lobby-screen')">Back</button></div>
    <div id="profile-screen" class="screen"><h2>My Profile</h2></div>
    <div id="withdraw-screen" class="screen"><h2>Withdraw</h2></div>

    <div class="footer">
        <div class="nav-item active" onclick="showScreen('lobby-screen')"><i class="fas fa-gamepad"></i><br>Game</div>
        <div class="nav-item" onclick="showScreen('profile-screen')"><i class="fas fa-user"></i><br>Profile</div>
        <div class="nav-item" onclick="showScreen('withdraw-screen')"><i class="fas fa-wallet"></i><br>Wallet</div>
    </div>
</div>

<script>
    // 1. Initialize TonConnect UI
    const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
        manifestUrl: 'https://phyothetnaing985.github.io/ton-odd-even-game-live/ton-connect.json',
        buttonRootId: 'ton-connect-btn'
    });

    // 2. Screen Switching Logic
    function showScreen(screenId) {
        document.querySelectorAll('.screen').forEach(s => s.style.display = 'none');
        document.getElementById(screenId).style.display = 'flex';
        
        // Update footer active state
        document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
    }

    // 3. Wallet Connection Watcher
    tonConnectUI.onStatusChange(wallet => {
        const playBtn = document.getElementById('play-now-btn');
        if (wallet) {
            playBtn.disabled = false;
            playBtn.innerText = "PLAY NOW";
            playBtn.onclick = () => showScreen('game-screen');
            console.log("Wallet Connected:", wallet.account.address);
        } else {
            playBtn.disabled = true;
            playBtn.innerText = "Connect Wallet to Play";
        }
    });

    // Telegram WebApp Initialization
    window.Telegram.WebApp.ready();
    window.Telegram.WebApp.expand();
</script>

</body>
</html>
